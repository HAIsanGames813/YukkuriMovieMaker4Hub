<Window x:Class="YukkuriMovieMaker4Hub.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:YukkuriMovieMaker4Hub"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        x:Name="RootWindow"
        Title="YukkuriMovieMaker4 Hub" Height="800" Width="1200" 
        Background="{DynamicResource ThemeBrush}"
        FontFamily="{DynamicResource AppFont}">
    <Window.Resources>
        <local:BooleanToStatusConverter x:Key="BooleanToStatusConverter"/>
        <local:BooleanToColorConverter x:Key="BooleanToColorConverter"/>
        <local:IsNotNullConverter x:Key="IsNotNullConverter"/>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <FontFamily x:Key="AppFont">Segoe UI</FontFamily>
        <SolidColorBrush x:Key="ThemeBrush" Color="#252525"/>
        <SolidColorBrush x:Key="PanelBrush" Color="#333333"/>
        <SolidColorBrush x:Key="ItemBrush" Color="#444444"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#2E7D32"/>
        <SolidColorBrush x:Key="TextBrush" Color="White"/>
        <SolidColorBrush x:Key="SubTextBrush" Color="#AAAAAA"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#555555"/>

        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
        </Style>

        <Style x:Key="ModernCheckBox" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <StackPanel Orientation="Horizontal">
                            <Grid Width="18" Height="18" VerticalAlignment="Center">
                                <Border x:Name="box" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="3" Background="{DynamicResource ItemBrush}"/>
                                <Path x:Name="mark" Data="M1,4.5 L4,7.5 L9,1.5" Stroke="White" StrokeThickness="2" Visibility="Collapsed" Margin="3"/>
                            </Grid>
                            <ContentPresenter Margin="8,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="box" Property="Background" Value="{DynamicResource AccentBrush}"/>
                                <Setter TargetName="box" Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                                <Setter TargetName="mark" Property="Visibility" Value="Visible"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="IconPathStyle" TargetType="Path">
            <Setter Property="Fill" Value="{DynamicResource TextBrush}"/>
            <Setter Property="Stretch" Value="Uniform"/>
            <Setter Property="Width" Value="20"/>
            <Setter Property="Height" Value="20"/>
            <Setter Property="Margin" Value="0,0,10,0"/>
        </Style>

        <Style TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource ItemBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="{DynamicResource ItemBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Grid.Column="2">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton">
                                        <Border x:Name="Border" CornerRadius="4" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                            <Grid HorizontalAlignment="Right">
                                                <Path x:Name="Arrow" Fill="{DynamicResource TextBrush}" Data="M0,0 L4,4 L8,0 Z" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            <ContentPresenter x:Name="ContentSite" IsHitTestVisible="False" Content="{TemplateBinding SelectionBoxItem}" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" Margin="10,3,30,3" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                            <Popup x:Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                <Grid x:Name="DropDown" SnapsToDevicePixels="True" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder" Background="{DynamicResource PanelBrush}" BorderThickness="1" BorderBrush="{DynamicResource BorderBrush}" CornerRadius="4"/>
                                    <ScrollViewer Margin="1" SnapsToDevicePixels="True">
                                        <ScrollViewer.Resources>
                                            <Style TargetType="{x:Type ScrollBar}">
                                                <Setter Property="Stylus.IsPressAndHoldEnabled" Value="false"/>
                                                <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
                                                <Setter Property="Width" Value="8"/>
                                                <Setter Property="Margin" Value="2,0"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type ScrollBar}">
                                                            <Grid x:Name="Bg" SnapsToDevicePixels="true">
                                                                <Track x:Name="PART_Track" IsDirectionReversed="true" IsEnabled="{TemplateBinding IsEnabled}">
                                                                    <Track.Thumb>
                                                                        <Thumb x:Name="Thumb">
                                                                            <Thumb.Template>
                                                                                <ControlTemplate TargetType="{x:Type Thumb}">
                                                                                    <Border Background="{DynamicResource ItemBrush}" CornerRadius="4" />
                                                                                </ControlTemplate>
                                                                            </Thumb.Template>
                                                                        </Thumb>
                                                                    </Track.Thumb>
                                                                </Track>
                                                            </Grid>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="true">
                                                                    <Setter TargetName="Thumb" Property="Background" Value="{DynamicResource AccentBrush}" />
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </ScrollViewer.Resources>
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ComboBoxItem">
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" BorderThickness="0" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ItemBrush}"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="GridViewColumnHeader">
            <Setter Property="Background" Value="{DynamicResource PanelBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderThickness" Value="0,0,0,2"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GridViewColumnHeader">
                        <Grid>
                            <Border x:Name="HeaderBorder" Background="{TemplateBinding Background}" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" Padding="{TemplateBinding Padding}">
                                <ContentPresenter x:Name="HeaderContent" VerticalAlignment="Center" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="HeaderBorder" Property="Background" Value="{DynamicResource ItemBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="{DynamicResource PanelBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0,0,0,2"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridColumnHeader">
                        <Grid>
                            <Border x:Name="HeaderBorder" Background="{TemplateBinding Background}" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" Padding="{TemplateBinding Padding}">
                                <ContentPresenter VerticalAlignment="Center" HorizontalAlignment="Left"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="HeaderBorder" Property="Background" Value="{DynamicResource ItemBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TabControl">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabControl">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <StackPanel IsItemsHost="True" Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,5"/>
                            <Border Grid.Row="1" Background="Transparent">
                                <ContentPresenter ContentSource="SelectedContent"/>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TabItem">
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="Foreground" Value="{DynamicResource SubTextBrush}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Grid>
                            <Border x:Name="border" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" Margin="0,0,2,0">
                                <ContentPresenter x:Name="content" VerticalAlignment="Center" HorizontalAlignment="Center" ContentSource="Header"/>
                            </Border>
                            <Border x:Name="underline" Height="3" VerticalAlignment="Bottom" Background="Transparent" Margin="5,0"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="content" Property="TextBlock.Foreground" Value="{DynamicResource TextBrush}"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="content" Property="TextBlock.Foreground" Value="{DynamicResource TextBrush}"/>
                                <Setter TargetName="underline" Property="Background" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="RowBackground" Value="Transparent"/>
            <Setter Property="AlternatingRowBackground" Value="#11FFFFFF"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="CellStyle">
                <Setter.Value>
                    <Style TargetType="DataGridCell">
                        <Setter Property="Padding" Value="10,12"/>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
                                        <ContentPresenter VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="RowStyle">
                <Setter.Value>
                    <Style TargetType="DataGridRow">
                        <Setter Property="Background" Value="Transparent"/>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{DynamicResource ItemBrush}"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Background" Value="{DynamicResource ItemBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="CaretBrush" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Grid>
                            <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="4"/>
                            <ScrollViewer x:Name="PART_ContentHost" Focusable="false" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden" Margin="10,0"/>
                            <TextBlock x:Name="placeholder" IsHitTestVisible="False" Text="{TemplateBinding Tag}" VerticalAlignment="Center" Margin="12,0" Foreground="{DynamicResource SubTextBrush}" Visibility="Collapsed"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="Text" Value=""/>
                                    <Condition Property="IsFocused" Value="False"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="placeholder" Property="Visibility" Value="Visible"/>
                            </MultiTrigger>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Grid Grid.Column="0" Background="{DynamicResource PanelBrush}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Grid.Resources>
                <Style x:Key="QuickActionButtonStyle" TargetType="Button">
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="Width" Value="28"/>
                    <Setter Property="Height" Value="28"/>
                    <Setter Property="Margin" Value="2,0"/>
                    <Setter Property="Cursor" Value="Hand"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="btnBorder" Background="{TemplateBinding Background}" CornerRadius="4">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="btnBorder" Property="Background" Value="#40FFFFFF"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Grid.Resources>

            <TextBlock Text="インスタンス" Margin="10" FontWeight="Bold" Foreground="{DynamicResource TextBrush}"/>

            <ListBox x:Name="InstanceListBox" Grid.Row="1" ItemsSource="{Binding Instances}" SelectedItem="{Binding SelectedInstance}" Background="Transparent" BorderThickness="0" Margin="5">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Grid Grid.Column="0" Width="32" Height="32" Margin="0,0,10,0">
                                <Ellipse Fill="{DynamicResource BorderBrush}"/>
                                <Image Source="{Binding IconImage}" Stretch="UniformToFill">
                                    <Image.Clip>
                                        <EllipseGeometry Center="16,16" RadiusX="16" RadiusY="16"/>
                                    </Image.Clip>
                                </Image>
                                <Path Fill="{DynamicResource SubTextBrush}" Width="16" Height="16" Stretch="Uniform" VerticalAlignment="Center" HorizontalAlignment="Center" Data="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,6A2,2 0 0,0 10,8A2,2 0 0,0 12,10A2,2 0 0,0 14,8A2,2 0 0,0 12,6M12,13C14.67,13 20,14.33 20,17V20H4V17C4,14.33 9.33,13 12,13M12,14.9C9.03,14.9 5.9,16.36 5.9,17V18.1H18.1V17C18.1,16.36 14.97,14.9 12,14.9Z">
                                    <Path.Style>
                                        <Style TargetType="Path">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IconImage}" Value="{x:Null}">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Path.Style>
                                </Path>
                            </Grid>


                            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                <Button Style="{StaticResource QuickActionButtonStyle}" Click="InstanceLaunch_Click" ToolTip="起動">
                                    <Path Fill="{DynamicResource TextBrush}" Width="14" Height="14" Stretch="Uniform" Data="M8,5.14V19.14L19,12.14L8,5.14Z"/>
                                </Button>
                                <Button Style="{StaticResource QuickActionButtonStyle}" Click="InstanceLaunchLastProject_Click" ToolTip="前回のプロジェクト">
                                    <Path Fill="{DynamicResource TextBrush}" Width="14" Height="14" Stretch="Uniform" Data="M13.5,8H12V13L16.28,15.54L17,14.33L13.5,12.25V8M13,3A9,9 0 0,0 4,12H1L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3Z"/>
                                </Button>
                                <Button Style="{StaticResource QuickActionButtonStyle}" Click="InstanceCreateNewProject_Click" ToolTip="新規作成">
                                    <Path Fill="{DynamicResource TextBrush}" Width="14" Height="14" Stretch="Uniform" Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                                </Button>
                            </StackPanel>
                            <TextBlock Grid.Column="2" Text="{Binding Name}" VerticalAlignment="Center" FontSize="13" Foreground="{DynamicResource TextBrush}" TextTrimming="CharacterEllipsis"/>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
            <StackPanel Grid.Row="2" Margin="10">
                <Button Click="AddInstance_Click" Margin="0,3" Height="35">
                    <StackPanel Orientation="Horizontal">
                        <Path Style="{StaticResource IconPathStyle}" Width="15" Height="15" Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                        <TextBlock Text="追加" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
                <Button Click="DeleteInstance_Click" Margin="0,3" Height="35">
                    <StackPanel Orientation="Horizontal">
                        <Path Style="{StaticResource IconPathStyle}" Width="15" Height="15" Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19V4M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/>
                        <TextBlock Text="削除" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>

        <Grid Grid.Column="1" Margin="5">
            <TabControl Background="Transparent" BorderThickness="0" SelectionChanged="TabControl_SelectionChanged">
                <TabItem Header="概要">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                            <Button Width="80" Height="80" Click="ChangeIcon_Click" Padding="0">
                                <Grid>
                                    <Border Background="{DynamicResource ItemBrush}" CornerRadius="4"/>
                                    <Image Source="{Binding SelectedInstance.IconImage}" Stretch="UniformToFill">
                                        <Image.Clip>
                                            <RectangleGeometry Rect="0,0,80,80" RadiusX="4" RadiusY="4"/>
                                        </Image.Clip>
                                    </Image>
                                </Grid>
                            </Button>
                            <StackPanel Margin="20,0">
                                <TextBox Text="{Binding SelectedInstance.Name, UpdateSourceTrigger=PropertyChanged}" FontSize="24" Background="Transparent" BorderThickness="0,0,0,1" Width="300" HorizontalAlignment="Left" Tag="インスタンス名"/>
                                <TextBlock Text="{Binding SelectedInstance.ExePath}" Foreground="{DynamicResource SubTextBrush}" Margin="0,10" FontSize="10"/>
                            </StackPanel>
                        </StackPanel>

                        <UniformGrid Grid.Row="1" Columns="4" Margin="0,0,0,20">
                            <Button Click="LaunchInstance_Click" Height="60" Margin="5" Background="{DynamicResource AccentBrush}">
                                <StackPanel Orientation="Horizontal">
                                    <Path Fill="White" Width="20" Height="20" Stretch="Uniform" Margin="0,0,10,0" Data="M8,5.14V19.14L19,12.14L8,5.14Z"/>
                                    <TextBlock Text="起動" FontSize="16" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Click="OpenFolder_Click" Height="60" Margin="5">
                                <StackPanel Orientation="Horizontal">
                                    <Path Fill="{DynamicResource TextBrush}" Width="20" Height="20" Stretch="Uniform" Margin="0,0,10,0" Data="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"/>
                                    <TextBlock Text="フォルダ" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Click="LaunchLastProject_Click" Height="60" Margin="5">
                                <StackPanel Orientation="Horizontal">
                                    <Path Fill="{DynamicResource TextBrush}" Width="20" Height="20" Stretch="Uniform" Margin="0,0,10,0" Data="M13.5,8H12V13L16.28,15.54L17,14.33L13.5,12.25V8M13,3A9,9 0 0,0 4,12H1L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3Z"/>
                                    <TextBlock Text="前回のプロジェクトを開く" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button Click="CreateNewProject_Click" Height="60" Margin="5">
                                <StackPanel Orientation="Horizontal">
                                    <Path Fill="{DynamicResource TextBrush}" Width="20" Height="20" Stretch="Uniform" Margin="0,0,10,0" Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                                    <TextBlock Text="新規作成" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </UniformGrid>

                        <Grid Grid.Row="2" Margin="5,0,5,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Grid Grid.Column="0">
                                <TextBox Text="{Binding ProjectSearchText, UpdateSourceTrigger=PropertyChanged}" Height="45" Tag="プロジェクト・ファイル名で検索..."/>
                                <Path IsHitTestVisible="False" Fill="{DynamicResource SubTextBrush}" Width="18" Height="18" Stretch="Uniform" HorizontalAlignment="Right" Margin="0,0,15,0" Data="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L19.71,19L18.29,20.41L13.01,15.14C11.87,16.11 10.39,16.7 8.5,16.7A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5A4.5,4.5 0 0,0 5,9.5A4.5,4.5 0 0,0 9.5,14A4.5,4.5 0 0,0 14,9.5A4.5,4.5 0 0,0 9.5,5Z"/>
                            </Grid>

                            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0,0,0">
                                <CheckBox Content=".ymmp" IsChecked="{Binding ShowYmmp}" Style="{StaticResource ModernCheckBox}" Margin="0,0,15,0"/>
                                <CheckBox Content=".ymmpx" IsChecked="{Binding ShowYmmpx}" Style="{StaticResource ModernCheckBox}" Margin="0,0,20,0"/>
                                <CheckBox Content=".ymmx" IsChecked="{Binding ShowYmmx}" Style="{StaticResource ModernCheckBox}" Margin="0,0,20,0"/>
                                <Button Content="フィルタ解除" Click="ResetProjectFilters_Click" Padding="15,8" Background="Transparent" Foreground="{DynamicResource SubTextBrush}">
                                    <Button.Style>
                                        <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>
                        </Grid>

                        <DataGrid x:Name="ProjectGrid" Grid.Row="3" ItemsSource="{Binding FilteredProjects}" Margin="5" MouseDoubleClick="OpenProject_Click">
                            <DataGrid.Resources>
                                <Style TargetType="{x:Type ScrollBar}">
                                    <Setter Property="Stylus.IsPressAndHoldEnabled" Value="false"/>
                                    <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
                                    <Setter Property="Width" Value="8"/>
                                    <Setter Property="Margin" Value="2,0"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type ScrollBar}">
                                                <Grid x:Name="Bg" SnapsToDevicePixels="true">
                                                    <Track x:Name="PART_Track" IsDirectionReversed="true" IsEnabled="{TemplateBinding IsEnabled}">
                                                        <Track.Thumb>
                                                            <Thumb x:Name="Thumb">
                                                                <Thumb.Template>
                                                                    <ControlTemplate TargetType="{x:Type Thumb}">
                                                                        <Border Background="{DynamicResource ItemBrush}" CornerRadius="4" />
                                                                    </ControlTemplate>
                                                                </Thumb.Template>
                                                            </Thumb>
                                                        </Track.Thumb>
                                                    </Track>
                                                </Grid>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="true">
                                                        <Setter TargetName="Thumb" Property="Background" Value="{DynamicResource AccentBrush}" />
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGrid.Resources>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ファイル名" Binding="{Binding Name}" Width="*"/>
                                <DataGridTextColumn Header="最終更新日時" Binding="{Binding LastWriteTime, StringFormat='yyyy/MM/dd HH:mm'}" Width="150"/>
                                <DataGridTextColumn Header="サイズ" Binding="{Binding DisplaySize}" ClipboardContentBinding="{Binding FileSize}" Width="120" SortMemberPath="FileSize"/>
                                <DataGridTextColumn Header="拡張子" Binding="{Binding Extension}" Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </TabItem>

                <TabItem Header="プラグイン管理">
                    <TabItem.Resources>
                        <Style TargetType="{x:Type ScrollBar}">
                            <Setter Property="Stylus.IsPressAndHoldEnabled" Value="false"/>
                            <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
                            <Setter Property="Width" Value="8"/>
                            <Setter Property="Margin" Value="2,0"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                                        <Grid x:Name="Bg" SnapsToDevicePixels="true">
                                            <Track x:Name="PART_Track" IsDirectionReversed="true" IsEnabled="{TemplateBinding IsEnabled}">
                                                <Track.Thumb>
                                                    <Thumb x:Name="Thumb">
                                                        <Thumb.Template>
                                                            <ControlTemplate TargetType="{x:Type Thumb}">
                                                                <Border Background="{DynamicResource ItemBrush}" CornerRadius="4" />
                                                            </ControlTemplate>
                                                        </Thumb.Template>
                                                    </Thumb>
                                                </Track.Thumb>
                                            </Track>
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="true">
                                                <Setter TargetName="Thumb" Property="Background" Value="{DynamicResource AccentBrush}" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TabItem.Resources>
                    <Grid IsEnabled="{Binding SelectedInstance, Converter={StaticResource IsNotNullConverter}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <StackPanel Orientation="Horizontal" Margin="10,5">
                            <TextBlock Text="検索:" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{DynamicResource TextBrush}"/>
                            <TextBox Width="200" Text="{Binding LocalPluginSearchText, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,20,0" VerticalContentAlignment="Center"/>
                            <Button Click="BulkToggle_Click" Content="選択項目を有効/無効" Padding="15,5" Margin="0,0,10,0"/>
                            <Button Click="BulkDelete_Click" Content="選択項目を削除" Padding="15,5"/>
                        </StackPanel>
                        <ListView x:Name="LocalPluginList" Grid.Row="1" ItemsSource="{Binding LocalPlugins}" Background="Transparent" BorderThickness="0">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="BorderThickness" Value="0"/>
                                    <Setter Property="Padding" Value="0"/>
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="ListViewItem">
                                                <Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
                                                    <GridViewRowPresenter VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ItemBrush}"/>
                                                    </Trigger>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter TargetName="Bd" Property="Background" Value="{DynamicResource AccentBrush}"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Width="400">
                                        <GridViewColumnHeader Content="プラグイン名" Click="GridViewColumnHeader_Click"/>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding DisplayName}" Padding="5" Foreground="{DynamicResource TextBrush}" VerticalAlignment="Center"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Width="100">
                                        <GridViewColumnHeader Content="状態" Click="GridViewColumnHeader_Click"/>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock x:Name="StatusText" Text="{Binding IsEnabled, Converter={StaticResource BooleanToStatusConverter}}" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                <DataTemplate.Triggers>
                                                    <DataTrigger Binding="{Binding IsEnabled}" Value="True">
                                                        <Setter TargetName="StatusText" Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding IsEnabled}" Value="False">
                                                        <Setter TargetName="StatusText" Property="Foreground" Value="{DynamicResource SubTextBrush}"/>
                                                    </DataTrigger>
                                                </DataTemplate.Triggers>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="アクション" Width="200">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <Button Click="TogglePlugin_Click" Content="切替" Margin="2" Width="60"/>
                                                    <Button Click="DeletePlugin_Click" Content="削除" Margin="10,2,2,2" Width="60"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>

                <TabItem Header="プラグインポータル">
                    <TabItem.Resources>
                        <Style TargetType="{x:Type ScrollBar}">
                            <Setter Property="Stylus.IsPressAndHoldEnabled" Value="false"/>
                            <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
                            <Setter Property="Width" Value="8"/>
                            <Setter Property="Margin" Value="2,0"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                                        <Grid x:Name="Bg" SnapsToDevicePixels="true">
                                            <Track x:Name="PART_Track" IsDirectionReversed="true" IsEnabled="{TemplateBinding IsEnabled}">
                                                <Track.Thumb>
                                                    <Thumb x:Name="Thumb">
                                                        <Thumb.Template>
                                                            <ControlTemplate TargetType="{x:Type Thumb}">
                                                                <Border Background="{DynamicResource ItemBrush}" CornerRadius="4" />
                                                            </ControlTemplate>
                                                        </Thumb.Template>
                                                    </Thumb>
                                                </Track.Thumb>
                                            </Track>
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="true">
                                                <Setter TargetName="Thumb" Property="Background" Value="{DynamicResource AccentBrush}" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TabItem.Resources>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10,5">
                            <TextBlock Text="プラグイン検索:" VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{DynamicResource TextBrush}"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <TextBox Text="{Binding OnlinePluginSearchText, UpdateSourceTrigger=PropertyChanged}" Width="300" Tag="プラグインを検索..." />

                                <Grid Margin="5,0,0,0">
                                    <ToggleButton x:Name="FilterButton" Content="" FontFamily="Segoe MDL2 Assets" Width="40">
                                        <ToggleButton.Style>
                                            <Style TargetType="ToggleButton">
                                                <Setter Property="Background" Value="{DynamicResource ItemBrush}"/>
                                                <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="ToggleButton">
                                                            <Border Background="{TemplateBinding Background}" CornerRadius="2">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#555555"/>
                                                    </Trigger>
                                                    <Trigger Property="IsChecked" Value="True">
                                                        <Setter Property="Background" Value="#666666"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ToggleButton.Style>
                                    </ToggleButton>
                                    <Popup IsOpen="{Binding IsChecked, ElementName=FilterButton}" StaysOpen="False" PlacementTarget="{Binding ElementName=FilterButton}" Placement="Bottom">
                                        <Border Background="{DynamicResource PanelBrush}" BorderBrush="{DynamicResource ItemBrush}" BorderThickness="1" Padding="10" Width="200">
                                            <StackPanel>
                                                <TextBlock Text="タイプフィルター" FontWeight="Bold" Margin="0,0,0,10" Foreground="{DynamicResource TextBrush}"/>
                                                <ItemsControl ItemsSource="{Binding PluginTypeFilters}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <CheckBox Content="{Binding Name}" IsChecked="{Binding IsSelected}" Foreground="{DynamicResource TextBrush}" Margin="0,2"/>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                                <Separator Margin="0,10" Background="{DynamicResource TextBrush}"/>
                                                <Button Content="すべてチェック" Click="AllCheck_Click" Margin="0,2"/>
                                                <Button Content="すべて外す" Click="NoneCheck_Click" Margin="0,2"/>
                                            </StackPanel>
                                        </Border>
                                    </Popup>
                                    
                                </Grid>
                            </StackPanel>
                        </StackPanel>

                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="400"/>
                            </Grid.ColumnDefinitions>

                            <ListView Grid.Column="0" ItemsSource="{Binding OnlinePlugins}" SelectedItem="{Binding SelectedOnlinePlugin}" Background="Transparent" BorderThickness="0">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1" Padding="15">
                                            <StackPanel>
                                                <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="Bold" Foreground="{DynamicResource TextBrush}"/>
                                                <TextBlock Text="{Binding Author}" Foreground="{DynamicResource SubTextBrush}" FontSize="12" Margin="0,5,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ListBoxItem">
                                                    <Border x:Name="Bd" Background="{TemplateBinding Background}">
                                                        <ContentPresenter/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource AccentBrush}"/>
                                                        </Trigger>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ItemBrush}"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ListView.ItemContainerStyle>
                            </ListView>

                            <Grid Grid.Column="1" Background="{DynamicResource PanelBrush}" Margin="5,0,0,0">
                                <ScrollViewer Margin="15" Visibility="{Binding SelectedOnlinePlugin, Converter={StaticResource IsNotNullConverter}, ConverterParameter=Visible}">
                                    <StackPanel>
                                        <TextBlock Text="{Binding SelectedOnlinePlugin.Name}" FontSize="20" FontWeight="Bold" TextWrapping="Wrap" Foreground="{DynamicResource TextBrush}"/>
                                        <TextBlock Text="{Binding SelectedOnlinePlugin.Author}" Foreground="{DynamicResource SubTextBrush}" Margin="0,5"/>
                                        <TextBlock Text="{Binding SelectedOnlinePlugin.Description}" TextWrapping="Wrap" Margin="0,10" Foreground="{DynamicResource TextBrush}"/>
                                        <Border BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0" Margin="0,20"/>
                                        <Grid Margin="0,10">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel>
                                                <TextBlock Text="最新バージョン:" FontWeight="Bold" Foreground="{DynamicResource TextBrush}"/>
                                                <TextBlock Text="{Binding SelectedOnlinePlugin.LatestVersionName}" Foreground="Orange" FontWeight="Bold" FontSize="16"/>
                                            </StackPanel>
                                            <Button Grid.Column="1" Click="InstallPlugin_Click" Background="{DynamicResource AccentBrush}" Padding="20,10" IsEnabled="{Binding SelectedOnlinePlugin.SelectedVersion, Converter={StaticResource IsNotNullConverter}}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Path Fill="White" Width="16" Height="16" Stretch="Uniform" Margin="0,0,10,0" Data="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"/>
                                                    <TextBlock Text="インストール" FontWeight="Bold" VerticalAlignment="Center" Foreground="White"/>
                                                </StackPanel>
                                            </Button>
                                        </Grid>

                                        <Grid Margin="0,0,0,20">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <TextBlock Text="バージョン選択" Foreground="{DynamicResource TextBrush}" Margin="0,0,0,5"/>
                                            <ListBox ItemsSource="{Binding SelectedOnlinePlugin.Releases}" 
         SelectedItem="{Binding SelectedOnlinePlugin.SelectedVersion}" 
         Height="150" Margin="0,0,0,15"
         Background="{DynamicResource ItemBrush}"
         BorderBrush="{DynamicResource BorderBrush}"
         BorderThickness="1">
                                                <ListBox.Resources>
                                                    <Style TargetType="{x:Type ScrollBar}">
                                                        <Setter Property="Width" Value="8"/>
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="{x:Type ScrollBar}">
                                                                    <Grid x:Name="Bg" SnapsToDevicePixels="true">
                                                                        <Track x:Name="PART_Track" IsDirectionReversed="true">
                                                                            <Track.Thumb>
                                                                                <Thumb x:Name="Thumb">
                                                                                    <Thumb.Template>
                                                                                        <ControlTemplate TargetType="{x:Type Thumb}">
                                                                                            <Border Background="{DynamicResource PanelBrush}" CornerRadius="4" />
                                                                                        </ControlTemplate>
                                                                                    </Thumb.Template>
                                                                                </Thumb>
                                                                            </Track.Thumb>
                                                                        </Track>
                                                                    </Grid>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </ListBox.Resources>
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid Margin="2">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Grid.Column="0" Text="{Binding TagName}" Foreground="{DynamicResource TextBrush}" FontWeight="Bold"/>
                                                            <TextBlock Grid.Column="1" Text=" (プレリリース)" Foreground="Orange" Visibility="{Binding Prerelease, Converter={StaticResource BoolToVis}}" Margin="5,0,0,0"/>
                                                            <TextBlock Grid.Column="2" Text="{Binding PublishedAt, StringFormat=' - {0:yyyy/MM/dd}'}" Foreground="{DynamicResource SubTextBrush}" Margin="5,0,0,0"/>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                        </Grid>

                                        <TextBlock Text="※ .ymme ファイル等をダウンロードして実行します。" Margin="0,10,0,0" Foreground="{DynamicResource SubTextBrush}" FontSize="11" TextWrapping="Wrap"/>

                                        <ItemsControl ItemsSource="{Binding SelectedOnlinePlugin.AllLinks}" Margin="0,20,0,0">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Button Click="OpenUrl_Click" Tag="{Binding Url}" Margin="0,2" HorizontalContentAlignment="Left">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Image Source="{Binding FaviconUrl}" Width="16" Height="16" Margin="0,0,10,0"/>
                                                            <TextBlock Text="{Binding Label}"/>
                                                        </StackPanel>
                                                    </Button>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </ScrollViewer>
                            </Grid>
                        </Grid>
                    </Grid>
                </TabItem>

                <TabItem Header="Hub設定">
                    <Grid Margin="30">
                        <StackPanel MaxWidth="600" HorizontalAlignment="Left">
                            <TextBlock Text="Hubのカスタマイズ" FontSize="24" FontWeight="Bold" Margin="0,0,0,20" Foreground="{DynamicResource TextBrush}"/>

                            <TextBlock Text="動作設定" Margin="0,10,0,5" Foreground="{DynamicResource SubTextBrush}"/>
                            <CheckBox IsChecked="{Binding CloseOnLaunch}" Content="YMM4起動時にHubを終了する" Margin="0,0,0,10" Style="{StaticResource ModernCheckBox}"/>

                            <TextBlock Text="テーマ設定" Margin="0,10,0,5" Foreground="{DynamicResource SubTextBrush}"/>
                            <ComboBox ItemsSource="{Binding ThemeModes}" SelectedItem="{Binding SelectedTheme}" Height="35"/>

                            <TextBlock Text="UIフォント" Margin="0,20,0,5" Foreground="{DynamicResource SubTextBrush}"/>
                            <TextBox Text="{Binding FontSearchText, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,10" Tag="フォントを検索..."/>
                            <CheckBox IsChecked="{Binding IsJapaneseOnly}" Content="日本語フォントのみ" Margin="0,0,0,10" Style="{StaticResource ModernCheckBox}"/>
                            <ComboBox ItemsSource="{Binding FilteredFonts}" SelectedItem="{Binding SelectedFontItem}" Height="35">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DisplayName}" FontFamily="{Binding Family}" Foreground="{DynamicResource TextBrush}"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>

                            <TextBlock Text="編集データフォルダの監視" FontSize="18" FontWeight="Bold" Margin="0,30,0,10" Foreground="{DynamicResource TextBrush}"/>
                            <Button Content="フォルダを追加" Click="AddProjectDir_Click" HorizontalAlignment="Left" Padding="15,5"/>
                            <ItemsControl ItemsSource="{Binding ProjectDirectories}" Margin="0,10,0,0">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Margin="0,2">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBox Text="{Binding .}" IsReadOnly="True" VerticalContentAlignment="Center" Tag="フォルダパス"/>
                                            <Button Grid.Column="1" Click="RemoveProjectDir_Click" Content="削除" Margin="5,0,0,0"/>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <TextBlock Text="GitHub API 設定" FontSize="18" FontWeight="Bold" Margin="0,30,0,10" Foreground="{DynamicResource TextBrush}"/>
                            <TextBlock Text="プラグイン取得の制限を回避するための設定です。頻繁に取得制限が発生する場合に設定してください。" Foreground="{DynamicResource SubTextBrush}" TextWrapping="Wrap" Margin="0,0,0,10"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="トークン:" VerticalAlignment="Center" Margin="0,0,10,0" Foreground="{DynamicResource TextBrush}"/>
                                <PasswordBox x:Name="GitHubTokenBox" 
                 Grid.Column="1" 
                 PasswordChanged="GitHubTokenBox_PasswordChanged" 
                 Padding="5"
                 Background="{DynamicResource ItemBrush}"
                 Foreground="{DynamicResource TextBrush}"
                 BorderBrush="{DynamicResource SubTextBrush}"
                 BorderThickness="1"/>
                                <Button Content="トークンを発行する" 
            Grid.Column="2" 
            Click="IssueToken_Click"
            Margin="10,0,0,0"
            Padding="10,5"
            Background="{DynamicResource AccentBrush}"
            Foreground="White"
            BorderThickness="0"/>
                            </Grid>


                        </StackPanel>
                        
                    </Grid>
                    
                </TabItem>
            </TabControl>
        </Grid>
    </Grid>
</Window>